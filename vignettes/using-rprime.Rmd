---
title: "Quick start examples"
author: "Tristan Mahr"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Quick start demonstration}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r, echo = FALSE, message = FALSE}
library("rprime")
library("knitr")
opts_chunk$set(
  comment = "#>",
  error = FALSE,
  tidy = FALSE,
  collapse = TRUE)
```

`rprime` is an R package for parsing `.txt` generated by E-Prime, a program for 
running psychological experiments. 

## Overview

The main workflow for working with `rprime` involves:

1. `read_eprime`: reliably read in data from an Eprime log (`.txt`) file.
2. `FrameList`: extract the text in each `"LogFrame"` in the file, storing each 
   log-frame as an R list.
3. `preview_levels`, `preview_eprime`: explore the structure of the parsed 
   data.
4. `keep_levels`, `drop_levels`, `filter_in`, `filter_out`: select and filter 
   particular levels from the txt-file..
5.  `to_data_frame`: make a data-frame from the parsed data.


## Examples

Loading and parsing a file.

```{r}
# Read in an Eprime text file
experiment_lines <- read_eprime("data/SAILS/SAILS_001X00XS1.txt")

# Extract and parse the log-frames from the file
experiment_data <- FrameList(experiment_lines)
```

Exploring and filtering frames from a file.

```{r}
# Run-down of different log-frames in the FrameList
preview_levels(experiment_data)

# Filter (out) by depth of nesting
not_level_1 <- drop_levels(experiment_data, 1)
preview_levels(not_level_1)

# Filter (in) by depth of nesting
just_level_3 <- keep_levels(experiment_data, 3)

# Preview each kind of log-frame in the FrameList
preview_eprime(just_level_3)

# Filter (out) by attribute values
no_header <- filter_out(experiment_data, "Running", values = "Header")
preview_levels(no_header)

# Filter (in) by attribute values
not_practice <- filter_in(experiment_data, "Running", "TrialLists")
preview_eprime(not_practice)

# Drill down into a FrameList
sue_trials <- filter_in(not_practice, "Module", "SUE")
preview_eprime(sue_trials)
```

Convert to a dataframe.

```{r}
# Export to dataframe
columns_to_keep <- c("Eprime.Basename", "Module", "Sample", 
                     "Correct", "Response")
sue_trials_df <- to_data_frame(sue_trials)[columns_to_keep]
head(sue_trials_df)
```


